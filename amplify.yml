version: 1
frontend:
  runtime-versions:
    nodejs: 20
  phases:
    preBuild:
      commands:
        - echo "ğŸ” Listing root directory:" && ls -al
        - |
          # Try crm-frontend first, then fallback to frontend
          if [ -d crm-frontend ]; then
            cd crm-frontend
          elif [ -d frontend ]; then
            cd frontend
          else
            echo "âŒ No crm-frontend or frontend folder found" && exit 1
          fi
        - echo "ğŸ“‚ Now in $(pwd), running npm ci" && npm ci
    build:
      commands:
        - |
          # repeat same folder logic for build
          if [ -d crm-frontend ]; then
            cd crm-frontend
          elif [ -d frontend ]; then
            cd frontend
          fi
        - echo "ğŸ“‚ Building from $(pwd)" && npm run build
  artifacts:
    baseDirectory: crm-frontend/build
    files:
      - '**/*'
  cache:
    paths:
      - crm-frontend/node_modules/**/*